
R : Copyright 2005, The R Foundation for Statistical Computing
Version 2.1.1  (2005-06-20), ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> 
> ### Regression tests for multiple adjustments
> 
> set.seed(290875)
> library(coin)
Loading required package: survival
Loading required package: splines
Loading required package: mvtnorm
Loading required package: modeltools
> isequal <- coin:::isequal
> 
> ### example from Westfall & Wolfinger (1997), Table 4
> tab <- as.table(matrix(c(12, 1, 3, 8, 17, 12, 9, 9, 16, 24), nrow = 2,
+     dimnames = list(group = c("Placebo", "Active"),
+                     response = c("Very Poor", "Poor", "Fair", "Good",
+ "Excellent"))))
> df <- coin:::table2df(tab)
> 
> it <- independence_test(response ~ group, data = df,
+                         distr = approximate(B = 100000))
> 
> ### Table 5, last column: OK
> pvalue(it, adjusted = TRUE, method = "step-down")
        Very Poor    Poor    Fair Good Excellent
Placebo   0.00689 0.24334 0.56908    1   0.21351
> 

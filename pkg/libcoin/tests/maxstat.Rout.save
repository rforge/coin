
R version 3.3.1 (2016-06-21) -- "Bug in Your Hair"
Copyright (C) 2016 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> library("libcoin")
> library("coin")
Loading required package: survival
> 
> set.seed(29)
> n <- 100
> B <- 1000
> x <- round(runif(n), 2)
> y <- rnorm(n, mean = x < .5, sd = 2.6)
> y2 <- runif(n)
> blk <- gl(4, n/4)
> ux <- sort(unique(x))
> ix <- unclass(cut(x, breaks = c(-Inf, ux[-length(ux)] + diff(ux) / 2, Inf)))
> 
> (mt <- maxstat_test(y ~ x , distrib = approximate(B = 1000)))

	Approximative Generalized Maximally Selected Statistics

data:  y by x
maxT = 1.7163, p-value = 0.542
alternative hypothesis: two.sided
sample estimates:
  "best" cutpoint: <= 0.53

> lev <- LinStatExpCov(ix, y, B = 1000)
> (tst <- doTest(lev, teststat = "maximum"))
$TestStatistic
[1] 1.716274

$p.value
[1] 0.555

$index
[1] 41

> ux[tst$index]
[1] 0.53
> (tst <- doTest(lev, teststat = "quadratic"))
$TestStatistic
[1] 2.945596

$p.value
[1] 0.555

$index
[1] 41

> ux[tst$index]
[1] 0.53
> lev <- LinStatExpCov(ix, y, B = 1000, varonly = TRUE)
> (tst <- doTest(lev, teststat = "maximum"))
$TestStatistic
[1] 1.716274

$p.value
[1] 0.545

$index
[1] 41

> ux[tst$index]
[1] 0.53
> (tst <- doTest(lev, teststat = "quadratic"))
$TestStatistic
[1] 2.945596

$p.value
[1] 0.545

$index
[1] 41

> ux[tst$index]
[1] 0.53
> 
> (mt <- maxstat_test(y ~ x | blk, distrib = approximate(B = 1000)))

	Approximative Generalized Maximally Selected Statistics

data:  y by x 
	 stratified by blk
maxT = 1.4647, p-value = 0.742
alternative hypothesis: two.sided
sample estimates:
  "best" cutpoint: <= 0.53

> lev <- LinStatExpCov(ix, y, block = blk, B = 1000)
> (tst <- doTest(lev, teststat = "maximum"))
$TestStatistic
[1] 1.464717

$p.value
[1] 0.732

$index
[1] 41

> ux[tst$index]
[1] 0.53
> (tst <- doTest(lev, teststat = "quadratic"))
$TestStatistic
[1] 2.145397

$p.value
[1] 0.732

$index
[1] 41

> ux[tst$index]
[1] 0.53
> lev <- LinStatExpCov(ix, y, block = blk, B = 1000, varonly = TRUE)
> try(tst <- doTest(lev, teststat = "maximum"))
Error in doTest(lev, teststat = "maximum") : 
  Cannot extract covariance from variance only object
> 
> (mt <- maxstat_test(y + y2 ~ x , distrib = approximate(B = 1000)))

	Approximative Generalized Maximally Selected Statistics

data:  y, y2 by x
maxT = 1.7163, p-value = 0.773
alternative hypothesis: two.sided
sample estimates:
  "best" cutpoint: <= 0.53

> lev <- LinStatExpCov(ix, cbind(y, y2), B = 1000)
> (tst <- doTest(lev, teststat = "maximum"))
$TestStatistic
[1] 1.716274

$p.value
[1] 0.793

$index
[1] 41

> ux[tst$index]
[1] 0.53
> (tst <- doTest(lev, teststat = "quadratic"))
$TestStatistic
[1] 3.162814

$p.value
[1] 0.853

$index
[1] 41

> ux[tst$index]
[1] 0.53
> lev <- LinStatExpCov(ix, cbind(y, y2), B = 1000, varonly = TRUE)
> (tst <- doTest(lev, teststat = "maximum"))
$TestStatistic
[1] 1.716274

$p.value
[1] 0.79

$index
[1] 41

> ux[tst$index]
[1] 0.53
> (tst <- doTest(lev, teststat = "quadratic"))
$TestStatistic
[1] 3.162814

$p.value
[1] 0.854

$index
[1] 41

> ux[tst$index]
[1] 0.53
> 
> (mt <- maxstat_test(y + y2 ~ x | blk, distrib = approximate(B = 1000)))

	Approximative Generalized Maximally Selected Statistics

data:  y, y2 by x 
	 stratified by blk
maxT = 1.4647, p-value = 0.936
alternative hypothesis: two.sided
sample estimates:
  "best" cutpoint: <= 0.53

> lev <- LinStatExpCov(ix, cbind(y, y2), block = blk, B = 1000)
> (tst <- doTest(lev, teststat = "maximum"))
$TestStatistic
[1] 1.464717

$p.value
[1] 0.931

$index
[1] 41

> ux[tst$index]
[1] 0.53
> (tst <- doTest(lev, teststat = "quadratic"))
$TestStatistic
[1] 2.256057

$p.value
[1] 0.968

$index
[1] 41

> ux[tst$index]
[1] 0.53
> lev <- LinStatExpCov(ix, cbind(y, y2), block = blk, B = 1000, varonly = TRUE)
> try(tst <- doTest(lev, teststat = "maximum"))
Error in doTest(lev, teststat = "maximum") : 
  Cannot extract covariance from variance only object
> 
> x <- sample(gl(5, n))
> y <- rnorm(length(x), mean = x %in% levels(x)[c(1, 3, 5)], sd = 4.5)
> y2 <- runif(length(x))
> ix <- unclass(x)
> blk <- gl(5, n)
> 
> (mt <- maxstat_test(y ~ x , distrib = approximate(B = 1000)))

	Approximative Generalized Maximally Selected Statistics

data:  y by x (1, 2, 3, 4, 5)
maxT = 2.0077, p-value = 0.282
alternative hypothesis: two.sided
sample estimates:
  "best" cutpoint: {1, 2, 4} vs. {3, 5}

> lev <- LinStatExpCov(ix, y, B = 1000)
> (tst <- doTest(lev, teststat = "maximum", ordered = FALSE))
$TestStatistic
[1] 2.007672

$p.value
[1] 0.286

$index
[1] 0 0 1 0 1

> (tst <- doTest(lev, teststat = "quadratic", ordered = FALSE))
$TestStatistic
[1] 4.030746

$p.value
[1] 0.286

$index
[1] 0 0 1 0 1

> lev <- LinStatExpCov(ix, y, B = 1000, varonly = TRUE)
> (tst <- doTest(lev, teststat = "maximum", ordered = FALSE))
$TestStatistic
[1] 2.007672

$p.value
[1] 0.315

$index
[1] 0 0 1 0 1

> (tst <- doTest(lev, teststat = "quadratic", ordered = FALSE))
$TestStatistic
[1] 4.030746

$p.value
[1] 0.315

$index
[1] 0 0 1 0 1

> 
> (mt <- maxstat_test(y ~ x | blk, distrib = approximate(B = 1000)))

	Approximative Generalized Maximally Selected Statistics

data:  y by x (1, 2, 3, 4, 5) 
	 stratified by blk
maxT = 2.0087, p-value = 0.318
alternative hypothesis: two.sided
sample estimates:
  "best" cutpoint: {1, 2, 4} vs. {3, 5}

> lev <- LinStatExpCov(ix, y, block = blk, B = 1000)
> (tst <- doTest(lev, teststat = "maximum", ordered = FALSE))
$TestStatistic
[1] 2.008749

$p.value
[1] 0.273

$index
[1] 0 0 1 0 1

> (tst <- doTest(lev, teststat = "quadratic", ordered = FALSE))
$TestStatistic
[1] 4.035071

$p.value
[1] 0.273

$index
[1] 0 0 1 0 1

> lev <- LinStatExpCov(ix, y, block = blk, B = 1000, varonly = TRUE)
> try(tst <- doTest(lev, teststat = "maximum", ordered = FALSE))
Error in doTest(lev, teststat = "maximum", ordered = FALSE) : 
  Cannot extract covariance from variance only object
> 
> (mt <- maxstat_test(y + y2 ~ x , distrib = approximate(B = 1000)))

	Approximative Generalized Maximally Selected Statistics

data:  y, y2 by x (1, 2, 3, 4, 5)
maxT = 2.0077, p-value = 0.502
alternative hypothesis: two.sided
sample estimates:
  "best" cutpoint: {1, 2, 4} vs. {3, 5}

> lev <- LinStatExpCov(ix, cbind(y, y2), B = 1000)
> (tst <- doTest(lev, teststat = "maximum", ordered = FALSE))
$TestStatistic
[1] 2.007672

$p.value
[1] 0.509

$index
[1] 0 0 1 0 1

> (tst <- doTest(lev, teststat = "quadratic", ordered = FALSE))
$TestStatistic
[1] 6.736531

$p.value
[1] 0.256

$index
[1] 0 0 0 1 0

> lev <- LinStatExpCov(ix, cbind(y, y2), B = 1000, varonly = TRUE)
> (tst <- doTest(lev, teststat = "maximum", ordered = FALSE))
$TestStatistic
[1] 2.007672

$p.value
[1] 0.511

$index
[1] 0 0 1 0 1

> (tst <- doTest(lev, teststat = "quadratic", ordered = FALSE))
$TestStatistic
[1] 6.736531

$p.value
[1] 0.252

$index
[1] 0 0 0 1 0

> 
> (mt <- maxstat_test(y + y2 ~ x | blk, distrib = approximate(B = 1000)))

	Approximative Generalized Maximally Selected Statistics

data:  y, y2 by x (1, 2, 3, 4, 5) 
	 stratified by blk
maxT = 2.0087, p-value = 0.506
alternative hypothesis: two.sided
sample estimates:
  "best" cutpoint: {1, 2, 4} vs. {3, 5}

> lev <- LinStatExpCov(ix, cbind(y, y2), block = blk, B = 50)
> (tst <- doTest(lev, teststat = "maximum", ordered = FALSE))
$TestStatistic
[1] 2.008749

$p.value
[1] 0.44

$index
[1] 0 0 1 0 1

> (tst <- doTest(lev, teststat = "quadratic", ordered = FALSE))
$TestStatistic
[1] 7.568605

$p.value
[1] 0.14

$index
[1] 0 0 0 1 0

> 
> xx <- factor(x == levels(x)[tst$index == 1])
> (it <- independence_test(y + y2 ~ xx | blk, teststat = "quadratic"))

	Asymptotic General Independence Test

data:  y, y2 by xx (FALSE, TRUE) 
	 stratified by blk
chi-squared = 7.5686, df = 2, p-value = 0.02272

> 
> lev <- LinStatExpCov(ix, cbind(y, y2), block = blk, B = 1000, varonly = TRUE)
> try(tst <- doTest(lev, teststat = "maximum", ordered = FALSE))
Error in doTest(lev, teststat = "maximum", ordered = FALSE) : 
  Cannot extract covariance from variance only object
> 
> proc.time()
   user  system elapsed 
  1.532   0.044   1.574 

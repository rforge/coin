
R version 3.3.1 (2016-06-21) -- "Bug in Your Hair"
Copyright (C) 2016 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> ### Regression tests for the correlation problem, i.e.,
> ### testing the independence of two numeric variables
> ### `x' and `y' (possibly blocked)
> 
> set.seed(290875)
> library("coin")
Loading required package: survival
> library("libcoin")
> source("check_vs_coin.R")
> 
> isequal <- coin:::isequal
> options(useFancyQuotes = FALSE)
> 
> ### generate data
> dat <- data.frame(x = rnorm(100), y = rnorm(100), block = gl(10, 10))
> 
> ### not really the same, T = (rank(x) - rank(y))^2 is used here
> cor.test(~ x + y, data = dat, method = "spearman")$p.value
[1] 0.8474266
> cor.test(~ x + y, data = dat, alternative = "less", method = "spearman")$p.value
[1] 0.5763332
> cor.test(~ x + y, data = dat, alternative = "greater", method = "spearman")$p.value
[1] 0.4237133
> 
> ### without blocks
> pvalue(lc("spearman_test",y ~ x, data = dat))
[1] TRUE
[1] 0.846517
> pvalue(lc("spearman_test",x ~ y, data = dat))
[1] TRUE
[1] 0.846517
> pvalue(lc("spearman_test", ~ y + x, data = dat))
[1] TRUE
[1] 0.846517
> pvalue(lc("spearman_test", ~ x + y, data = dat))
[1] TRUE
[1] 0.846517
> 
> pvalue(lc("fisyat_test",y ~ x, data = dat))
[1] TRUE
[1] 0.9155477
> pvalue(lc("fisyat_test",x ~ y, data = dat))
[1] TRUE
[1] 0.9155477
> pvalue(lc("fisyat_test", ~ y + x, data = dat))
[1] TRUE
[1] 0.9155477
> pvalue(lc("fisyat_test", ~ x + y, data = dat))
[1] TRUE
[1] 0.9155477
> 
> pvalue(lc("quadrant_test",y ~ x, data = dat))
[1] TRUE
[1] 0.6906339
> pvalue(lc("quadrant_test",x ~ y, data = dat))
[1] TRUE
[1] 0.6906339
> pvalue(lc("quadrant_test", ~ y + x, data = dat))
[1] TRUE
[1] 0.6906339
> pvalue(lc("quadrant_test", ~ x + y, data = dat))
[1] TRUE
[1] 0.6906339
> 
> pvalue(lc("koziol_test",y ~ x, data = dat))
[1] TRUE
[1] 0.7825737
> pvalue(lc("koziol_test",x ~ y, data = dat))
[1] TRUE
[1] 0.7825737
> pvalue(lc("koziol_test", ~ y + x, data = dat))
[1] TRUE
[1] 0.7825737
> pvalue(lc("koziol_test", ~ x + y, data = dat))
[1] TRUE
[1] 0.7825737
> 
> ### with blocks
> pvalue(lc("spearman_test",y ~ x | block, data = dat))
[1] TRUE
[1] 0.8901013
> pvalue(lc("spearman_test",x ~ y | block, data = dat))
[1] TRUE
[1] 0.8901013
> pvalue(lc("spearman_test", ~ y + x | block, data = dat))
[1] TRUE
[1] 0.8901013
> pvalue(lc("spearman_test", ~ x + y | block, data = dat))
[1] TRUE
[1] 0.8901013
> 
> pvalue(lc("fisyat_test",y ~ x | block, data = dat))
[1] TRUE
[1] 0.9061762
> pvalue(lc("fisyat_test",x ~ y | block, data = dat))
[1] TRUE
[1] 0.9061762
> pvalue(lc("fisyat_test", ~ y + x | block, data = dat))
[1] TRUE
[1] 0.9061762
> pvalue(lc("fisyat_test", ~ x + y | block, data = dat))
[1] TRUE
[1] 0.9061762
> 
> pvalue(lc("quadrant_test",y ~ x | block, data = dat))
[1] TRUE
[1] 0.7489036
> pvalue(lc("quadrant_test",x ~ y | block, data = dat))
[1] TRUE
[1] 0.7489036
> pvalue(lc("quadrant_test", ~ y + x | block, data = dat))
[1] TRUE
[1] 0.7489036
> pvalue(lc("quadrant_test", ~ x + y | block, data = dat))
[1] TRUE
[1] 0.7489036
> 
> pvalue(lc("koziol_test",y ~ x | block, data = dat))
[1] TRUE
[1] 0.8408785
> pvalue(lc("koziol_test",x ~ y | block, data = dat))
[1] TRUE
[1] 0.8408785
> pvalue(lc("koziol_test", ~ y + x | block, data = dat))
[1] TRUE
[1] 0.8408785
> pvalue(lc("koziol_test", ~ x + y | block, data = dat))
[1] TRUE
[1] 0.8408785
> 
> ### sanity checks, those should be errors
> dat <- data.frame(x = gl(2, 50), y = rnorm(100), block = rnorm(100))
> 
> try(lc("spearman_test",y ~ x, data = dat))
Error in check(object) : 
  'object' does not represent a univariate correlation problem
> try(lc("spearman_test",y ~ x | block, data = dat))
Error in .local(.Object, ...) : 'block' is not a factor
> 
> try(lc("fisyat_test",y ~ x, data = dat))
Error in check(object) : 
  'object' does not represent a univariate correlation problem
> try(lc("fisyat_test",y ~ x | block, data = dat))
Error in .local(.Object, ...) : 'block' is not a factor
> 
> try(lc("quadrant_test",y ~ x, data = dat))
Error in check(object) : 
  'object' does not represent a univariate correlation problem
> try(lc("quadrant_test",y ~ x | block, data = dat))
Error in .local(.Object, ...) : 'block' is not a factor
> 
> try(lc("koziol_test",y ~ x, data = dat))
Error in check(object) : 
  'object' does not represent a univariate correlation problem
> try(lc("koziol_test",y ~ x | block, data = dat))
Error in .local(.Object, ...) : 'block' is not a factor
> 
> proc.time()
   user  system elapsed 
  1.420   0.032   1.448 

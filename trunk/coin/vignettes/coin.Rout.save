
R version 2.14.1 (2011-12-22)
Copyright (C) 2011 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: i686-pc-linux-gnu (32-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.
> options(width = 60)

> require("coin")
Loading required package: coin
Loading required package: survival
Loading required package: splines
Loading required package: mvtnorm
Loading required package: modeltools
Loading required package: stats4
Loading required package: multcomp

> require("Biobase")
Loading required package: Biobase

Welcome to Bioconductor

  Vignettes contain introductory material. To view, type
  'openVignette()'. To cite Bioconductor, see
  'citation("Biobase")' and for packages 'citation(pkgname)'.


> require("multcomp")

> set.seed(290875)

> library("coin")

> YOY <- data.frame(length = c(46, 28, 46, 37, 32, 41, 
+     42, 45, 38, 44, 42, 60, 32, 42, 45, 58, 27, 51, 42, 52, 38, 
+     33, 26, 25, 28, 28, 2 .... [TRUNCATED] 

> it <- independence_test(length ~ site, data = YOY, 
+     ytrafo = function(data) trafo(data, numeric_trafo = rank), 
+     teststat = "quadtype")

> it

	Asymptotic General Independence Test

data:  length by site (I, II, III, IV) 
chi-squared = 22.8524, df = 3, p-value = 4.335e-05


> statistic(it, "linear")
       
I   278
II  307
III 119
IV  116

> expectation(it)
  I  II III  IV 
205 205 205 205 

> covariance(it)
            I        II       III        IV
I   1019.0385 -339.6795 -339.6795 -339.6795
II  -339.6795 1019.0385 -339.6795 -339.6795
III -339.6795 -339.6795 1019.0385 -339.6795
IV  -339.6795 -339.6795 -339.6795 1019.0385

> statistic(it, "standardized")
             
I    2.286797
II   3.195250
III -2.694035
IV  -2.788013

> statistic(it)
[1] 22.85242

> pvalue(it)
[1] 4.334659e-05

> kw <- kruskal_test(length ~ site, data = YOY, distribution = approximate(B = 9999))

> kw

	Approximative Kruskal-Wallis Test

data:  length by site (I, II, III, IV) 
chi-squared = 22.8524, p-value < 2.2e-16


> pvalue(kw)
[1] 0
99 percent confidence interval:
 0.0000000000 0.0005297444 


> data("jobsatisfaction", package = "coin")

> it <- cmh_test(jobsatisfaction)

> it

	Asymptotic Generalized Cochran-Mantel-Haenszel Test

data:  Job.Satisfaction by
	 Income (<5000, 5000-15000, 15000-25000, >25000) 
	 stratified by Gender 
chi-squared = 10.2001, df = 9, p-value = 0.3345


> statistic(it, "standardized")
            Very Dissatisfied A Little Satisfied
<5000               1.3112789         0.69201053
5000-15000          0.6481783         0.83462550
15000-25000        -1.0958361        -1.50130926
>25000             -1.0377629        -0.08983052
            Moderately Satisfied Very Satisfied
<5000                 -0.2478705     -0.9293458
5000-15000             0.5175755     -1.6257547
15000-25000            0.2361231      1.4614123
>25000                -0.5946119      1.2031648

> lbl_test(jobsatisfaction)

	Asymptotic Linear-by-Linear Association Test

data:  Job.Satisfaction (ordered) by
	 Income (<5000 < 5000-15000 < 15000-25000 < >25000) 
	 stratified by Gender 
chi-squared = 6.6235, df = 1, p-value = 0.01006


> lbl_test(jobsatisfaction, scores = list(Job.Satisfaction = c(1, 
+     3, 4, 5), Income = c(3, 10, 20, 35)))

	Asymptotic Linear-by-Linear Association Test

data:  Job.Satisfaction (ordered) by
	 Income (<5000 < 5000-15000 < 15000-25000 < >25000) 
	 stratified by Gender 
chi-squared = 6.1563, df = 1, p-value = 0.01309


> egg_data <- data.frame(scores = c(9.7, 8.7, 5.4, 5, 
+     9.6, 8.8, 5.6, 3.6, 9, 7.3, 3.8, 4.3, 9.3, 8.7, 6.8, 3.8, 
+     10, 7.5, 4.2, 2.8, 9.6,  .... [TRUNCATED] 

> yt <- function(data) trafo(data, numeric_trafo = rank, 
+     block = egg_data$sitting)

> independence_test(scores ~ product | sitting, data = egg_data, 
+     teststat = "quadtype", ytrafo = yt)

	Asymptotic General Independence Test

data:  scores by
	 product (1, 2, 3, 4, 5, 6, 7, 8, 9, 10) 
	 stratified by sitting 
chi-squared = 39.12, df = 9, p-value = 1.096e-05


> pvalue(independence_test(scores ~ product | sitting, 
+     data = egg_data, teststat = "quadtype", ytrafo = yt, distribution = approximate(B = 1999 .... [TRUNCATED] 
[1] 0
99 percent confidence interval:
 0.000000000 0.000264894 


> independence_test(scores ~ product | sitting, data = egg_data, 
+     scores = list(product = 1:10), ytrafo = yt)

	Asymptotic General Independence Test

data:  scores by
	 product (1 < 2 < 3 < 4 < 5 < 6 < 7 < 8 < 9 < 10) 
	 stratified by sitting 
Z = -6.2166, p-value = 5.081e-10
alternative hypothesis: two.sided 


> if (require("multcomp")) {
+     xt <- function(data) trafo(data, factor_trafo = function(x) model.matrix(~x - 
+         1) %*% t(contrMat(table(x) .... [TRUNCATED] 
[1] 0.00010001
99 percent confidence interval:
 5.013042e-07 7.428484e-04 

                   
II - I   0.64726473
III - I  0.03680368
IV - I   0.02110211
III - II 0.00010001
IV - II  0.00010001
IV - III 0.99799980

 *** Run successfully completed ***
